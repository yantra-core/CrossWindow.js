!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).CW=e()}(function(){return function r(o,i,a){function s(t,e){if(!i[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}n=i[t]={exports:{}},o[t][0].call(n.exports,function(e){return s(o[t][1][e]||e)},n,n.exports,r,o,i,a)}return i[t].exports}for(var c="function"==typeof require&&require,e=0;e<a.length;e++)s(a[e]);return s}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"CrossWindow",{enumerable:!0,get:function(){return r.default}}),n.createCrossWindow=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new r.default(e)};var r=(n=e("./lib/CrossWindow.js"))&&n.__esModule?n:{default:n}},{"./lib/CrossWindow.js":3}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=(e=e("./EventReceiver.js"))&&e.__esModule?e:{default:e};function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==o(e)?e:String(e)}(r.key),r)}}n.default=function(){function o(e,t,n,r){if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");this.channel=e,this.windowId=t.windowId,this.cw=t,this.metadataManager=r,this.eventReceiver=new i.default(t),this.setupListeners()}var e,t,n;return e=o,(t=[{key:"setupListeners",value:function(){var n=this;this.channel.onmessage=function(e){var t=e.data;switch(t.action){case"ping":t.sourceWindowId!==n.windowId&&n.channel.postMessage({action:"pong",sourceWindowId:n.windowId});break;case"pong":t.sourceWindowId!==n.windowId&&n.metadataManager.markWindowAsActive(t.sourceWindowId);break;case"message":"any"===t.targetWindowId&&n.cw.emit("message",t),t.targetWindowId===n.windowId&&n.cw.emit("message",t);break;case"intersecting":t.sourceWindowId!==n.windowId&&n.cw.emit("intersecting",t);break;case"keydown":case"keyup":t.sourceWindowId!==n.windowId&&(n.eventReceiver.handleKeyboardEvent(t),n.cw.emit("keyEvent",t));break;case"mouseEvent":n.eventReceiver.handleMouseEvent(t),n.cw.emit("mouseEvent",t)}}}},{key:"sendMessage",value:function(e){e.targetWindowId===this.windowId?this.cw.emit("message",{sourceWindowId:this.windowId,payload:e}):((e=JSON.parse(JSON.stringify(e))).sourceWindowId=this.windowId,this.channel.postMessage(e))}}])&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}()},{"./EventReceiver.js":4}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(e("./getBestWindow.js")),a=r(e("./open.js")),s=r(e("./CommunicationManager.js")),c=r(e("./MetadataManager.js")),u=r(e("./IntersectionDetector.js")),d=r(e("./KeyboardEventBroadcaster.js")),l=r(e("./MouseEventBroadcaster.js"));function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==o(e)?e:String(e)}(r.key),r)}}n.default=function(){function o(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=this,r=o;if(!(n instanceof r))throw new TypeError("Cannot call a class as a function");this.window=e,this.config={},this.config.metadataKey=t.metadataKey||"windowMetadata",this.config.broadcastKeyboardEvents=!0,this.config.broadcastMouseEvents=!0,"boolean"==typeof t.broadcastKeyboardEvents&&(this.config.broadcastKeyboardEvents=t.broadcastKeyboardEvents),"boolean"==typeof t.broadcastMouseEvents&&(this.config.broadcastMouseEvents=t.broadcastMouseEvents),this.events={},this.windowId="".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),this.metadataManager=new c.default(this),this.communicationManager=new s.default(new BroadcastChannel("crosswindow_channel"),this,null,this.metadataManager),this.intersectionDetector=new u.default(this.metadataManager,this.windowId),this.config.broadcastKeyboardEvents&&(this.keyboardEventBroadcaster=new d.default(this)),this.config.broadcastMouseEvents&&(this.mouseEventBroadcaster=new l.default(this)),this.open=a.default.bind(this),this.getBestWindow=i.default.bind(this),this.getWindows=this.metadataManager.getWindows.bind(this.metadataManager),this.getWindowById=this.metadataManager.getWindowById.bind(this.metadataManager),this.getCurrentWindows=this.metadataManager.getCurrentWindows.bind(this.metadataManager),this.getWindowMetadata=this.metadataManager.getWindowMetadata.bind(this),this.postMessage=this.communicationManager.sendMessage.bind(this.communicationManager),this.registerWindow(),this.metadataManager.startHeartbeat(),this.metadataManager.startWindowEventPolling()}var e,t,n;return e=o,(t=[{key:"on",value:function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}},{key:"emit",value:function(e,t){e=this.events[e];e&&e.forEach(function(e){return e(t)})}},{key:"registerWindow",value:function(){this.metadataManager.updateWindowMetadata(),this.pingOtherWindows()}},{key:"pingOtherWindows",value:function(){var e=this;new BroadcastChannel("crosswindow_channel").postMessage({action:"ping",sourceWindowId:this.windowId}),setTimeout(function(){return e.metadataManager.removeInactiveWindows()},100)}},{key:"deregisterWindow",value:function(){this.metadataManager.deregisterWindow()}}])&&f(e.prototype,t),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}()},{"./CommunicationManager.js":2,"./IntersectionDetector.js":5,"./KeyboardEventBroadcaster.js":6,"./MetadataManager.js":7,"./MouseEventBroadcaster.js":8,"./getBestWindow.js":9,"./open.js":10}],4:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==o(e)?e:String(e)}(r.key),r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.crosswindow=e}var e,n,r;return e=t,(n=[{key:"handleKeyboardEvent",value:function(e){e.sourceWindowId!==this.crosswindow.windowId&&(e=new KeyboardEvent(e.action,{code:e.message.code,repeat:e.message.repeat,shiftKey:e.message.shiftKey,ctrlKey:e.message.ctrlKey,altKey:e.message.altKey,metaKey:e.message.metaKey,bubbles:!1}),document.dispatchEvent(e))}},{key:"handleMouseEvent",value:function(e){e.sourceWindowId!==this.crosswindow.windowId&&(e=new MouseEvent(e.message.type,{clientX:e.message.x,clientY:e.message.y,button:e.message.button,ctrlKey:e.message.ctrlKey,shiftKey:e.message.shiftKey,altKey:e.message.altKey,metaKey:e.message.metaKey,bubbles:!1}),document.dispatchEvent(e))}}])&&i(e.prototype,n),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}()},{}],5:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){var n;if(e)return"string"==typeof e?r(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==o(e)?e:String(e)}(r.key),r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(){function n(e,t){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");this.metadataManager=e,this.windowId=t,this.prevMetadata=null,this.startMetadataPolling()}var e,t,r;return e=n,(t=[{key:"startMetadataPolling",value:function(){var t=this;this.prevMetadata=this.metadataManager.getWindowMetadata(),setInterval(function(){var e=t.metadataManager.getWindowMetadata();t.metadataManager.hasMetadataChanged(t.prevMetadata,e)&&(t.metadataManager.updateWindowMetadata(e),t.checkForIntersections(e))},100)}},{key:"checkForIntersections",value:function(n){var r=this,e=JSON.parse(localStorage.getItem(this.metadataManager.metadataKey))||{};Object.entries(e).forEach(function(e){var e=i(e,2),t=e[0],e=e[1];t!==r.windowId&&r.isOverlapping(n,e)&&r.emitIntersectionEvent(t,r.calculateIntersection(n,e))})}},{key:"isOverlapping",value:function(e,t){return!(t.position.x>=e.position.x+e.size.width||t.position.x+t.size.width<=e.position.x||t.position.y>=e.position.y+e.size.height||t.position.y+t.size.height<=e.position.y)}},{key:"calculateIntersection",value:function(e,t){var n=Math.max(e.position.x,t.position.x),r=Math.max(e.position.y,t.position.y);return{position:{x:n,y:r},size:{width:Math.min(e.position.x+e.size.width,t.position.x+t.size.width)-n,height:Math.min(e.position.y+e.size.height,t.position.y+t.size.height)-r}}}},{key:"emitIntersectionEvent",value:function(e,t){new BroadcastChannel("crosswindow_channel").postMessage({action:"intersecting",sourceWindowId:this.windowId,targetWindowId:e,intersectionArea:t})}}])&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),n}()},{}],6:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==o(e)?e:String(e)}(r.key),r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.cw=e,this.initEventListeners()}var e,n,r;return e=t,(n=[{key:"initEventListeners",value:function(){window.document.addEventListener("keydown",this.handleKeyboardEvent.bind(this)),window.document.addEventListener("keyup",this.handleKeyboardEvent.bind(this))}},{key:"handleKeyboardEvent",value:function(e){var t;!1!==e.bubbles&&(t={key:e.key,code:e.code,keyCode:e.keyCode,repeat:e.repeat,type:e.type,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,altKey:e.altKey,metaKey:e.metaKey,bubbles:!1},this.cw.communicationManager.sendMessage({targetWindowId:"any",action:e.type,message:t}))}}])&&i(e.prototype,n),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}()},{}],7:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){var n;if(e)return"string"==typeof e?o(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function s(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?i(Object(o),!0).forEach(function(e){var t,n;t=r,n=o[e=e],(e=u(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,u(r.key),r)}}function u(e){e=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==r(e)?e:String(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.cw=e,this.config=e.config,this.windowId=e.windowId,this.emit=e.emit.bind(e),this.currentWindows={}}var e,n,r;return e=t,(n=[{key:"startHeartbeat",value:function(){var e=this;setInterval(function(){e.updateWindowMetadata(),e.removeInactiveWindows(660)},200)}},{key:"getCurrentWindows",value:function(){return JSON.parse(localStorage.getItem(this.config.metadataKey))||{}}},{key:"createWindowObject",value:function(t,e){var n=this,r={postMessage:function(e){e.targetWindowId=t,e.sourceWindowId=n.cw.windowId,e.action="message",n.cw.communicationManager.sendMessage(e)}};return r.windowId=t,r.metadata=e,r}},{key:"getWindows",value:function(){var r=this,o=JSON.parse(localStorage.getItem(this.config.metadataKey))||{};return Object.keys(o).reduce(function(e,t){var n=o[t],t=r.createWindowObject(t,n);return e[t.windowId]=t,e},{})}},{key:"getWindowById",value:function(e){var t=(JSON.parse(localStorage.getItem(this.config.metadataKey))||{})[e];return t?this.createWindowObject(e,t):(console.log("Window with ID ".concat(e," not found.")),null)}},{key:"hasMetadataChanged",value:function(e,t){return e.position.x!==t.position.x||e.position.y!==t.position.y||e.size.width!==t.size.width||e.size.height!==t.size.height}},{key:"getWindowMetadata",value:function(){return{position:{x:window.screenX,y:window.screenY},size:{width:window.outerWidth,height:window.outerHeight}}}},{key:"updateWindowMetadata",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getWindowMetadata(),t=JSON.parse(localStorage.getItem(this.config.metadataKey))||{},n=Date.now();(!t.hasOwnProperty(this.windowId)||n>t[this.windowId].lastUpdate)&&(t[this.windowId]=s(s({},e),{},{lastActive:n,lastUpdate:n}),localStorage.setItem(this.config.metadataKey,JSON.stringify(t)))}},{key:"startWindowEventPolling",value:function(){var r=this;this.prevMetadata=this.getWindows(),setInterval(function(){var n=r.getWindows();Object.keys(r.prevMetadata).forEach(function(e){e===r.windowId||n.hasOwnProperty(e)||r.emit("windowClosed",{windowId:e,metadata:r.prevMetadata[e]})}),Object.keys(n).forEach(function(e){var t=n[e],e=r.prevMetadata[e];e?r.hasMetadataChanged(e.metadata,t.metadata)&&r.emit("windowChanged",t):r.emit("windowOpened",t)}),r.prevMetadata=n},200)}},{key:"removeInactiveWindows",value:function(){var n=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e3,o=JSON.parse(localStorage.getItem(this.config.metadataKey))||{},i=Date.now();Object.entries(o).forEach(function(e){var e=a(e,2),t=e[0],e=e[1];i-e.lastActive>r&&(delete o[t],n.currentWindows[t]=null)}),localStorage.setItem(this.config.metadataKey,JSON.stringify(o))}},{key:"markWindowAsActive",value:function(e){var t=JSON.parse(localStorage.getItem(this.config.metadataKey))||{};t[e]&&(t[e].lastActive=Date.now(),localStorage.setItem(this.config.metadataKey,JSON.stringify(t)))}},{key:"deregisterWindow",value:function(){var e=JSON.parse(localStorage.getItem(this.config.metadataKey))||{};delete e[this.windowId],localStorage.setItem(this.config.metadataKey,JSON.stringify(e))}}])&&c(e.prototype,n),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}()},{}],8:[function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==o(e)?e:String(e)}(r.key),r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.cw=e,this.initEventListeners()}var e,n,r;return e=t,(n=[{key:"initEventListeners",value:function(){var t=this;["click","mousedown","mouseup","mousemove"].forEach(function(e){window.document.addEventListener(e,t.handleMouseEvent.bind(t))})}},{key:"handleMouseEvent",value:function(e){!1!==e.bubbles&&this.shouldBroadcastEvent(e)&&(e={type:e.type,x:e.clientX,y:e.clientY,button:e.button,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey,metaKey:e.metaKey},this.cw.communicationManager.sendMessage({targetWindowId:"any",action:"mouseEvent",message:e}))}},{key:"shouldBroadcastEvent",value:function(e){return!0}}])&&i(e.prototype,n),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}()},{}],9:[function(e,t,n){"use strict";function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){var n;if(e)return"string"==typeof e?r(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t,n,r){var r=3<arguments.length&&void 0!==r?r:1,o=(JSON.parse(localStorage.getItem("windowMetadata"))||{})[n];if(o){var i=o.size,a=(o.position,i.width/2),s=i.height/2;a*=r,s*=r;switch(e){case"E":case"NE":case"SE":t.x=-a/2+40;break;case"W":case"SW":case"NW":t.x=a/2-40;break;case"N":t.y=s/2-40;break;case"S":t.y=-s/2+40}return t}console.error("calculateEntryPosition: bestWindowMetadata not found for windowId",n)}function y(e,t,n,r,o){var i;switch(e){case"E":i=t.x-(r.x+o.width);break;case"W":i=r.x-(t.x+n.width);break;case"N":i=r.y-(t.y+n.height);break;case"S":i=t.y-(r.y+o.height);break;default:i=1/0}return i}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var r=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,o=function(e){if(e.direction)return e.direction;var e=e.screenPosition,t=window.screenX,n=window.screenX+window.outerWidth,r=window.screenY,o=window.screenY+window.outerHeight,t=e.x-t,n=n-e.x,r=e.y-r,o=o-e.y;return t<n&&t<r&&t<o?"W":n<t&&n<r&&n<o?"E":r<t&&r<n&&r<o?"N":o<t&&o<n&&o<r?"S":void 0}(e),n=JSON.parse(localStorage.getItem(this.config.metadataKey))||{},i={x:window.screenX,y:window.screenY},a={width:window.innerWidth,height:window.innerHeight},s=null,c=1/0,u=null,d=1/0;0===Object.keys(n).length&&(s=this.windowId);Object.entries(n).forEach(function(e){var t,e=l(e,2),n=e[0],e=e[1];n!==r.windowId&&(t=y(o,e.position,e.size,i,a),"E"===o&&e.position.x>i.x||"W"===o&&e.position.x<i.x||"N"===o&&e.position.y<i.y?t<c&&(c=t,s=n):"S"===o&&e.position.y>i.y&&t<c&&(c=t,s=n),t<d)&&(d=t,u=n)}),!s&&u&&(s=u);s=s||this.windowId;s===this.windowId&&1<Object.keys(n).length&&(delete n[this.windowId],c=1/0,Object.entries(n).forEach(function(e){var e=l(e,2),t=e[0],e=e[1],e=y(o,e.position,e.size,i,a);e<c&&(c=e,s=t)}));return function(n,r,o,e){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1;return{windowId:r,direction:o,entryPosition:f(o,e.position,r,i),postMessage:function(e){void 0===e.position&&(e.position={x:0,y:0,z:0});var t=f(o,e.position,r,i);e.position=t,e.direction=o,e.targetWindowId=r,n.communicationManager.sendMessage(e)}}}(this,s,o,e,t)}},{}],10:[function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function c(r){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?s(Object(o),!0).forEach(function(e){var t,n;t=r,n=o[e=e],(e=function(e){e=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==i(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):s(Object(o)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})}return r}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(e){var r=screen.availWidth-window.screenX,o=screen.availHeight-window.screenY,r=c(c({},{width:Math.min(window.outerWidth,r-100),height:Math.min(window.outerHeight,o-100),menubar:"no",toolbar:"no",location:"no",status:"no",scrollbars:"yes",resizable:"yes",title:(new Date).toISOString(),left:window.screenX+window.outerWidth+100,top:window.screenY}),t),t=(n&&(r.left+r.width>screen.availWidth||r.top+r.height>screen.availHeight)&&(o=Math.floor(window.outerWidth/2),t=Math.floor(window.outerHeight/2),n=window.screenX+o+r.width>screen.availWidth?screen.availWidth-r.width-o:window.screenX,window.screenY+t+r.height>screen.availHeight?(screen.availHeight,r.height):window.screenY,r.width=o,r.height=t,r.left=n+o),Object.entries(r).map(function(e){t=2;var e=function(e){if(Array.isArray(e))return e}(e=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){var n;if(e)return"string"==typeof e?a(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),t=e[0],e=e[1];return"".concat(t,"=").concat(e)}).join(",")),n=window.open(e,r.title,t);if(n)return n;console.error("Failed to open a new window. Please check browser popup settings.")}else console.error("URL is required to open a new window.")}},{}]},{},[1])(1)});
//# sourceMappingURL=crosswindow.min.js.map