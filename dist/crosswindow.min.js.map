{"version":3,"sourceRoot":"../","sources":["./dist/crosswindow.js"],"sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.CW = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"CrossWindow\", {\n  enumerable: true,\n  get: function get() {\n    return _CrossWindow[\"default\"];\n  }\n});\nexports.createCrossWindow = createCrossWindow;\nvar _CrossWindow = _interopRequireDefault(require(\"./lib/CrossWindow.js\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction createCrossWindow() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return new _CrossWindow[\"default\"](options);\n}\n\n},{\"./lib/CrossWindow.js\":3}],2:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nvar CommunicationManager = exports[\"default\"] = /*#__PURE__*/function () {\n  function CommunicationManager(channel, cw, game, metadataManager) {\n    _classCallCheck(this, CommunicationManager);\n    this.channel = channel;\n    this.windowId = cw.windowId;\n    this.game = game;\n    this.cw = cw;\n    this.metadataManager = metadataManager;\n    this.setupListeners();\n    this.startPing();\n  }\n  _createClass(CommunicationManager, [{\n    key: \"setupListeners\",\n    value: function setupListeners() {\n      var _this = this;\n      this.channel.onmessage = function (event) {\n        var data = event.data;\n        switch (data.action) {\n          case 'ping':\n            if (data.sourceWindowId !== _this.windowId) _this.channel.postMessage({\n              action: 'pong',\n              sourceWindowId: _this.windowId\n            });\n            break;\n          case 'pong':\n            if (data.sourceWindowId !== _this.windowId) _this.metadataManager.markWindowAsActive(data.sourceWindowId);\n            break;\n          case 'sendMessage':\n            if (data.targetWindowId === 'any') _this.cw.emit('message', data);\n            if (data.targetWindowId === _this.windowId) _this.cw.emit('message', data);\n            break;\n          case 'intersecting':\n            if (data.sourceWindowId !== _this.windowId) _this.cw.emit('intersecting', data);\n            break;\n        }\n      };\n    }\n  }, {\n    key: \"startPing\",\n    value: function startPing() {\n      var _this2 = this;\n      setInterval(function () {\n        _this2.channel.postMessage({\n          action: 'ping',\n          sourceWindowId: _this2.windowId\n        });\n      }, 1000); // Send ping every second\n    }\n  }, {\n    key: \"sendMessage\",\n    value: function sendMessage(targetWindowId, message) {\n      this.channel.postMessage({\n        action: 'sendMessage',\n        targetWindowId: targetWindowId,\n        sourceWindowId: this.windowId,\n        payload: message\n      });\n    }\n  }]);\n  return CommunicationManager;\n}();\n\n},{}],3:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nvar _getBestWindow = _interopRequireDefault(require(\"./getBestWindow.js\"));\nvar _open = _interopRequireDefault(require(\"./open.js\"));\nvar _CommunicationManager = _interopRequireDefault(require(\"./CommunicationManager.js\"));\nvar _MetadataManager = _interopRequireDefault(require(\"./MetadataManager.js\"));\nvar _IntersectionDetector = _interopRequireDefault(require(\"./IntersectionDetector.js\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); } // CrossWindow.js - Marak Squires 2024\n// A class to manage communication and entity movement between multiple windows\n// Supports opening new windows, sending messages, and teleporting entities between windows\n// Also supports detecting and handling window intersections\nvar CrossWindow = exports[\"default\"] = /*#__PURE__*/function () {\n  function CrossWindow(game) {\n    var metadataKey = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'windowMetadata';\n    _classCallCheck(this, CrossWindow);\n    this.game = game;\n    this.metadataKey = metadataKey;\n    this.events = {};\n    this.windowId = \"\".concat(Date.now(), \"-\").concat(Math.random().toString(36).substr(2, 9));\n    this.metadataManager = new _MetadataManager[\"default\"](metadataKey, this);\n    this.communicationManager = new _CommunicationManager[\"default\"](new BroadcastChannel('crosswindow_channel'), this, game, this.metadataManager);\n    //this.on = this.communicationManager.on.bind(this.communicationManager);\n    //this.emit = this.communicationManager.emit.bind(this.communicationManager);\n    this.intersectionDetector = new _IntersectionDetector[\"default\"](this.metadataManager, this.windowId);\n    this.open = _open[\"default\"].bind(this);\n    this.getBestWindow = _getBestWindow[\"default\"].bind(this);\n    this.getWindows = this.metadataManager.getWindows.bind(this.metadataManager);\n    this.getCurrentWindows = this.metadataManager.getCurrentWindows.bind(this.metadataManager);\n    this.getWindowMetadata = this.metadataManager.getWindowMetadata.bind(this);\n    this.pollWindows = this.metadataManager.pollWindows.bind(this.metadataManager);\n    this.postMessage = this.communicationManager.sendMessage.bind(this.communicationManager);\n    this.registerWindow();\n    this.pollWindows();\n    this.metadataManager.startHeartbeat();\n  }\n  _createClass(CrossWindow, [{\n    key: \"on\",\n    value: function on(eventName, callback) {\n      if (!this.events[eventName]) this.events[eventName] = [];\n      this.events[eventName].push(callback);\n    }\n  }, {\n    key: \"emit\",\n    value: function emit(eventName, data) {\n      var callbacks = this.events[eventName];\n      if (callbacks) callbacks.forEach(function (callback) {\n        return callback(data);\n      });\n    }\n  }, {\n    key: \"registerWindow\",\n    value: function registerWindow() {\n      this.metadataManager.updateWindowMetadata();\n      this.pingOtherWindows();\n    }\n  }, {\n    key: \"pingOtherWindows\",\n    value: function pingOtherWindows() {\n      var _this = this;\n      var channel = new BroadcastChannel('crosswindow_channel');\n      channel.postMessage({\n        action: 'ping',\n        sourceWindowId: this.windowId\n      });\n      setTimeout(function () {\n        return _this.metadataManager.removeInactiveWindows();\n      }, 100);\n    }\n  }, {\n    key: \"deregisterWindow\",\n    value: function deregisterWindow() {\n      this.metadataManager.deregisterWindow();\n    }\n  }]);\n  return CrossWindow;\n}();\n\n},{\"./CommunicationManager.js\":2,\"./IntersectionDetector.js\":4,\"./MetadataManager.js\":5,\"./getBestWindow.js\":6,\"./open.js\":7}],4:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n// The intersection detector class is responsible for detecting intersections between the current window and other windows.\n// This can be used to create \"x-ray\" style effects, or shared entities between windows.\nvar IntersectionDetector = exports[\"default\"] = /*#__PURE__*/function () {\n  function IntersectionDetector(metadataManager, windowId) {\n    _classCallCheck(this, IntersectionDetector);\n    this.metadataManager = metadataManager;\n    this.windowId = windowId;\n    this.prevMetadata = null;\n    this.startMetadataPolling();\n  }\n  _createClass(IntersectionDetector, [{\n    key: \"startMetadataPolling\",\n    value: function startMetadataPolling() {\n      var _this = this;\n      this.prevMetadata = this.metadataManager.getWindowMetadata();\n      setInterval(function () {\n        var currentMetadata = _this.metadataManager.getWindowMetadata();\n        if (_this.metadataManager.hasMetadataChanged(_this.prevMetadata, currentMetadata)) {\n          _this.metadataManager.updateWindowMetadata(currentMetadata);\n          _this.checkForIntersections(currentMetadata);\n        }\n      }, 100);\n    }\n  }, {\n    key: \"checkForIntersections\",\n    value: function checkForIntersections(currentMetadata) {\n      var _this2 = this;\n      var allWindowsMetadata = JSON.parse(localStorage.getItem(this.metadataManager.metadataKey)) || {};\n      Object.entries(allWindowsMetadata).forEach(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n          windowId = _ref2[0],\n          metadata = _ref2[1];\n        if (windowId !== _this2.windowId && _this2.isOverlapping(currentMetadata, metadata)) {\n          _this2.emitIntersectionEvent(windowId, _this2.calculateIntersection(currentMetadata, metadata));\n        }\n      });\n    }\n  }, {\n    key: \"isOverlapping\",\n    value: function isOverlapping(metadata1, metadata2) {\n      return !(metadata2.position.x >= metadata1.position.x + metadata1.size.width || metadata2.position.x + metadata2.size.width <= metadata1.position.x || metadata2.position.y >= metadata1.position.y + metadata1.size.height || metadata2.position.y + metadata2.size.height <= metadata1.position.y);\n    }\n  }, {\n    key: \"calculateIntersection\",\n    value: function calculateIntersection(metadata1, metadata2) {\n      var x1 = Math.max(metadata1.position.x, metadata2.position.x);\n      var y1 = Math.max(metadata1.position.y, metadata2.position.y);\n      var x2 = Math.min(metadata1.position.x + metadata1.size.width, metadata2.position.x + metadata2.size.width);\n      var y2 = Math.min(metadata1.position.y + metadata1.size.height, metadata2.position.y + metadata2.size.height);\n      return {\n        position: {\n          x: x1,\n          y: y1\n        },\n        size: {\n          width: x2 - x1,\n          height: y2 - y1\n        }\n      };\n    }\n  }, {\n    key: \"emitIntersectionEvent\",\n    value: function emitIntersectionEvent(targetWindowId, intersectionArea) {\n      var channel = new BroadcastChannel('crosswindow_channel');\n      channel.postMessage({\n        action: 'intersecting',\n        sourceWindowId: this.windowId,\n        targetWindowId: targetWindowId,\n        intersectionArea: intersectionArea\n      });\n    }\n  }]);\n  return IntersectionDetector;\n}();\n\n},{}],5:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nvar MetadataManager = exports[\"default\"] = /*#__PURE__*/function () {\n  function MetadataManager(metadataKey, cw) {\n    _classCallCheck(this, MetadataManager);\n    this.metadataKey = metadataKey;\n    this.windowId = cw.windowId;\n    this.emit = cw.emit.bind(cw);\n    this.currentWindows = {};\n  }\n  _createClass(MetadataManager, [{\n    key: \"getCurrentWindows\",\n    value: function getCurrentWindows() {\n      var _this = this;\n      var active = {};\n      // for each non-null currentWindows\n      Object.keys(this.currentWindows).forEach(function (windowId) {\n        if (_this.currentWindows[windowId]) {\n          active[windowId] = _this.currentWindows[windowId];\n        }\n      });\n      return active;\n    }\n  }, {\n    key: \"getWindows\",\n    value: function getWindows() {\n      return JSON.parse(localStorage.getItem(this.metadataKey)) || {};\n    }\n  }, {\n    key: \"startHeartbeat\",\n    value: function startHeartbeat() {\n      var _this2 = this;\n      setInterval(function () {\n        _this2.updateWindowMetadata(); // Update current window's metadata\n        _this2.removeInactiveWindows(200); // milliseconds\n      }, 200); // Update every 200ms\n    }\n  }, {\n    key: \"pollWindows\",\n    value: function pollWindows() {\n      var _this3 = this;\n      var prevMetadata = this.getWindows(); // Store the initial state of all windows.\n\n      setInterval(function () {\n        var allWindows = _this3.getWindows(); // Fetch the current state of all windows.\n\n        // Check for closed windows by comparing prevMetadata with the current state\n        Object.keys(prevMetadata).forEach(function (windowId) {\n          if (windowId === _this3.windowId) return; // Skip the current window\n          if (!allWindows.hasOwnProperty(windowId)) {\n            // If a window in prevMetadata is not present in allWindows, it's been closed\n            console.log('gone', windowId, prevMetadata[windowId]);\n            _this3.emit('windowClosed', {\n              windowId: windowId,\n              metadata: prevMetadata[windowId]\n            });\n          }\n        });\n\n        // Iterate through all current windows to check for changes or new windows\n        Object.keys(allWindows).forEach(function (windowId) {\n          var currentWindowMetadata = allWindows[windowId];\n          var prevWindowMetadata = prevMetadata[windowId];\n\n          // Check if the window is new or its metadata has changed\n          //if (!prevWindowMetadata || this.hasMetadataChanged(prevWindowMetadata, currentWindowMetadata)) {\n          // Update the previous metadata state for the next iteration\n          prevMetadata[windowId] = currentWindowMetadata;\n          _this3.currentWindows[windowId] = currentWindowMetadata;\n          // Emit an event for the changed or new window\n          // TODO: without the conditional statement this is now 'windowHeartbeat'\n          // we should split the case and have two events to subscribe to\n          _this3.emit('windowChanged', {\n            windowId: windowId,\n            metadata: currentWindowMetadata\n          });\n          // }\n        });\n\n        // Update prevMetadata to reflect the current state for the next iteration\n        prevMetadata = _objectSpread({}, allWindows);\n      }, 15);\n    }\n  }, {\n    key: \"hasMetadataChanged\",\n    value: function hasMetadataChanged(prevMetadata, currentMetadata) {\n      return prevMetadata.position.x !== currentMetadata.position.x || prevMetadata.position.y !== currentMetadata.position.y || prevMetadata.size.width !== currentMetadata.size.width || prevMetadata.size.height !== currentMetadata.size.height;\n    }\n  }, {\n    key: \"getWindowMetadata\",\n    value: function getWindowMetadata() {\n      return {\n        position: {\n          x: window.screenX,\n          y: window.screenY\n        },\n        size: {\n          width: window.innerWidth,\n          height: window.innerHeight\n        }\n      };\n    }\n  }, {\n    key: \"updateWindowMetadata\",\n    value: function updateWindowMetadata() {\n      var metadata = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.getWindowMetadata();\n      var allWindowsMetadata = JSON.parse(localStorage.getItem(this.metadataKey)) || {};\n      allWindowsMetadata[this.windowId] = _objectSpread(_objectSpread({}, metadata), {}, {\n        lastActive: Date.now()\n      });\n      localStorage.setItem(this.metadataKey, JSON.stringify(allWindowsMetadata));\n    }\n  }, {\n    key: \"removeInactiveWindows\",\n    value: function removeInactiveWindows() {\n      var _this4 = this;\n      var timeout = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1000;\n      var allWindowsMetadata = JSON.parse(localStorage.getItem(this.metadataKey)) || {};\n      var currentTime = Date.now();\n      //console.log('removeInactiveWindows', allWindowsMetadata, currentTime, timeout)\n      Object.entries(allWindowsMetadata).forEach(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n          windowId = _ref2[0],\n          metadata = _ref2[1];\n        if (currentTime - metadata.lastActive > timeout) {\n          console.log('removeInactiveWindows', windowId, metadata, currentTime, timeout);\n          delete allWindowsMetadata[windowId];\n          _this4.currentWindows[windowId] = null;\n        }\n      });\n      localStorage.setItem(this.metadataKey, JSON.stringify(allWindowsMetadata));\n    }\n  }, {\n    key: \"markWindowAsActive\",\n    value: function markWindowAsActive(windowId) {\n      var allWindowsMetadata = JSON.parse(localStorage.getItem(this.metadataKey)) || {};\n      if (allWindowsMetadata[windowId]) {\n        allWindowsMetadata[windowId].lastActive = Date.now();\n        localStorage.setItem(this.metadataKey, JSON.stringify(allWindowsMetadata));\n      }\n    }\n  }, {\n    key: \"deregisterWindow\",\n    value: function deregisterWindow() {\n      var allWindowsMetadata = JSON.parse(localStorage.getItem(this.metadataKey)) || {};\n      delete allWindowsMetadata[this.windowId];\n      localStorage.setItem(this.metadataKey, JSON.stringify(allWindowsMetadata));\n    }\n  }]);\n  return MetadataManager;\n}();\n\n},{}],6:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = getBestWindow;\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction calculateEntryPosition(direction, position, bestWindowId) {\n  // get the latest metadata about bestWindowId from localStorage\n  var allWindowsMetadata = JSON.parse(localStorage.getItem('windowMetadata')) || {};\n  var bestWindowMetadata = allWindowsMetadata[bestWindowId];\n  if (!bestWindowMetadata) {\n    console.error('calculateEntryPosition: bestWindowMetadata not found for windowId', bestWindowId);\n    return;\n  }\n\n  // console.log('bestWindowMetadata', bestWindowMetadata)\n\n  var bestWindowSize = bestWindowMetadata.size;\n  var bestWindowPosition = bestWindowMetadata.position;\n  // we need to determine if the calculated position is outside the bounds of the bestWindow\n  // if it is, we need to clamp the value to the edge of the window\n  // we are working with world coordinates at zoom scale value 1\n  // so we can calculate the world coordinates of the window edges by using\n  // the window position and size\n  var gameWidth = bestWindowSize.width / 2;\n  var gameHeight = bestWindowSize.height / 2;\n  var currentWindowPosition = {\n    x: screenX,\n    y: screenY\n  };\n\n  // console.log('currentWindowPosition', currentWindowPosition)\n  //console.log('bestWindowPosition', bestWindowPosition)\n  //console.log('bestWindowSize', bestWindowSize)\n\n  // Adjust this buffer size as needed\n  var buffer = 66; // any small values should work, without buffer the entity may get stuck in teleportation loop\n  console.log('calculateEntryPosition', direction, position);\n  switch (direction) {\n    case 'E':\n    case 'NE':\n    case 'SE':\n      position.x = -gameWidth / 2 + buffer;\n      break;\n    case 'W':\n    case 'SW':\n    case 'NW':\n      position.x = gameWidth / 2 - buffer;\n      break;\n    case 'N':\n      position.y = gameHeight / 2 - buffer;\n      break;\n    case 'S':\n      position.y = -gameHeight / 2 + buffer;\n      break;\n  }\n  return position;\n}\nfunction calculateDistance(point1, point2) {\n  var dx = point1.x - point2.x;\n  var dy = point1.y - point2.y;\n  return Math.sqrt(dx * dx + dy * dy);\n}\nfunction determineCardinalDirection(screenPosition) {\n  var centerX = window.innerWidth / 2;\n  var centerY = window.innerHeight / 2;\n\n  // Calculate the differences between the screen position and the center\n  var diffX = Math.abs(screenPosition.x - centerX);\n  var diffY = Math.abs(screenPosition.y - centerY);\n\n  // Determine the predominant direction based on the larger difference\n  if (diffX > diffY) {\n    // Horizontal movement is predominant\n    return screenPosition.x < centerX ? 'W' : 'E'; // West or East\n  } else {\n    // Vertical movement is predominant, or equal to horizontal movement\n    return screenPosition.y < centerY ? 'N' : 'S'; // North or South\n  }\n}\nfunction getBestWindow(entityData) {\n  var _this = this;\n  // TODO: entityData.position? we need an API semantic here for .position and .screenPosition\n  var direction = determineCardinalDirection(entityData.screenPosition);\n  var allWindowsMetadata = JSON.parse(localStorage.getItem(this.metadataKey)) || {};\n  if (Object.keys(allWindowsMetadata).length === 0) {\n    game.flashMessage('no other windows found');\n    return;\n  }\n  var currentWindowPosition = getCurrentWindowPosition();\n  var currentWindowSize = getCurrentWindowSize();\n  var bestWindowId = null;\n  var minEdgeDistance = Infinity;\n  var fallbackWindowId = null;\n  var minFallbackDistance = Infinity;\n  Object.entries(allWindowsMetadata).forEach(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n      windowId = _ref2[0],\n      metadata = _ref2[1];\n    if (windowId !== _this.windowId) {\n      var edgeDistance = calculateEdgeDistance(direction, metadata.position, metadata.size, currentWindowPosition, currentWindowSize);\n      if (direction === 'E' && metadata.position.x > currentWindowPosition.x) {\n        // Consider windows to the right for East direction\n        if (edgeDistance < minEdgeDistance) {\n          minEdgeDistance = edgeDistance;\n          bestWindowId = windowId;\n        }\n      } else if (direction === 'W' && metadata.position.x < currentWindowPosition.x) {\n        // Consider windows to the left for West direction\n        if (edgeDistance < minEdgeDistance) {\n          minEdgeDistance = edgeDistance;\n          bestWindowId = windowId;\n        }\n      } // Add similar checks for 'N' and 'S' directions if needed\n      else if (direction === 'N' && metadata.position.y < currentWindowPosition.y) {\n        // Consider windows to the left for West direction\n        if (edgeDistance < minEdgeDistance) {\n          minEdgeDistance = edgeDistance;\n          bestWindowId = windowId;\n        }\n      } else if (direction === 'S' && metadata.position.y > currentWindowPosition.y) {\n        // Consider windows to the left for West direction\n        if (edgeDistance < minEdgeDistance) {\n          minEdgeDistance = edgeDistance;\n          bestWindowId = windowId;\n        }\n      }\n      // Fallback for when no window is found in the preferred direction\n      if (edgeDistance < minFallbackDistance) {\n        minFallbackDistance = edgeDistance;\n        fallbackWindowId = windowId;\n      }\n    }\n  });\n\n  // If no suitable window is found in the preferred direction, use the fallback\n  if (!bestWindowId && fallbackWindowId) {\n    bestWindowId = fallbackWindowId;\n  }\n  if (!bestWindowId) {\n    bestWindowId = this.windowId;\n  }\n  return prepareBestWindowResponse(this, bestWindowId, direction, entityData);\n}\n\n// Helper function to get the current window's position\n// Implement this based on how you track window positions in your application\nfunction getCurrentWindowPosition() {\n  // Example return value\n  return {\n    x: window.screenX,\n    y: window.screenY\n  };\n}\n\n// Helper function to get the current window's size\nfunction getCurrentWindowSize() {\n  // Example return value\n  return {\n    width: window.innerWidth,\n    height: window.innerHeight\n  };\n}\nfunction calculateEdgeDistance(direction, targetWindowPosition, targetWindowSize, currentWindowPosition, currentWindowSize) {\n  var edgeDistance;\n  // console.log('calculateEdgeDistance', direction, targetWindowPosition, targetWindowSize, currentWindowPosition, currentWindowSize)\n  switch (direction) {\n    case 'E':\n      // Entity is moving East, so we calculate the distance from the current window's right edge to the target window's left edge\n      edgeDistance = targetWindowPosition.x - (currentWindowPosition.x + currentWindowSize.width);\n      break;\n    case 'W':\n      // Entity is moving West, so we calculate the distance from the current window's left edge to the target window's right edge\n      edgeDistance = currentWindowPosition.x - (targetWindowPosition.x + targetWindowSize.width);\n      break;\n    case 'N':\n      // Entity is moving North, so we calculate the distance from the current window's top edge to the target window's bottom edge\n      edgeDistance = currentWindowPosition.y - (targetWindowPosition.y + targetWindowSize.height);\n      break;\n    case 'S':\n      // Entity is moving South, so we calculate the distance from the current window's bottom edge to the target window's top edge\n      edgeDistance = targetWindowPosition.y - (currentWindowPosition.y + currentWindowSize.height);\n      break;\n    // Handle diagonal directions if needed by combining logic for horizontal and vertical edges\n    // e.g., for NE, use the logic from N and E to find the shortest edge distance\n    default:\n      edgeDistance = Infinity; // Default case to handle unexpected directions\n      break;\n  }\n\n  // console.log('calcuate distance', edgeDistance, direction, targetWindowPosition, targetWindowSize, currentWindowPosition, currentWindowSize)\n\n  return edgeDistance;\n}\nfunction prepareBestWindowResponse(cw, bestWindowId, direction, entityData) {\n  return {\n    windowId: bestWindowId,\n    direction: direction,\n    entryPosition: calculateEntryPosition(direction, entityData.position, bestWindowId),\n    postMessage: function postMessage(data) {\n      var newEntryPosition = calculateEntryPosition(direction, data.position, bestWindowId);\n      data.position = newEntryPosition;\n      data.direction = direction;\n      cw.communicationManager.sendMessage(bestWindowId, data);\n    }\n  };\n}\n\n},{}],7:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = open;\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nfunction open(url) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var adjustCurrentWindow = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  if (!url) {\n    console.error('URL is required to open a new window.');\n    return;\n  }\n  var availableScreenWidth = screen.availWidth - window.screenX;\n  var availableScreenHeight = screen.availHeight - window.screenY;\n  var defaultFeatures = {\n    width: Math.min(window.outerWidth, availableScreenWidth - 100),\n    height: Math.min(window.outerHeight, availableScreenHeight - 100),\n    menubar: 'no',\n    toolbar: 'no',\n    location: 'no',\n    status: 'no',\n    scrollbars: 'yes',\n    resizable: 'yes',\n    title: new Date().toISOString(),\n    left: window.screenX + window.outerWidth + 100,\n    top: window.screenY\n  };\n  var features = _objectSpread(_objectSpread({}, defaultFeatures), options);\n  if (adjustCurrentWindow && (features.left + features.width > screen.availWidth || features.top + features.height > screen.availHeight)) {\n    var halfWidth = Math.floor(window.outerWidth / 2);\n    var halfHeight = Math.floor(window.outerHeight / 2);\n\n    // window.resizeTo(halfWidth, halfHeight);\n\n    // Determine an appropriate offset to maintain proximity without overlap\n    var offsetX = window.screenX + halfWidth + features.width > screen.availWidth ? screen.availWidth - features.width - halfWidth : window.screenX;\n    var offsetY = window.screenY + halfHeight + features.height > screen.availHeight ? screen.availHeight - features.height - halfHeight : window.screenY;\n\n    // window.moveTo(offsetX, offsetY);\n\n    features.width = halfWidth;\n    features.height = halfHeight;\n    features.left = offsetX + halfWidth; // Place new window to the right of the resized current window\n    // features.top = offsetY; // Align new window's top with the current window's top\n  }\n  var featuresStr = Object.entries(features).map(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n      key = _ref2[0],\n      value = _ref2[1];\n    return \"\".concat(key, \"=\").concat(value);\n  }).join(',');\n  var newWindow = window.open(url, features.title, featuresStr);\n  if (newWindow) {\n    return newWindow;\n  } else {\n    console.error('Failed to open a new window. Please check browser popup settings.');\n  }\n}\n\n},{}]},{},[1])(1)\n});\n"],"names":["f","exports","module","define","amd","window","global","self","this","CW","r","e","n","t","o","i","c","require","u","a","Error","code","p","call","length","1","Object","defineProperty","value","enumerable","get","_CrossWindow","createCrossWindow","options","arguments","undefined","obj","__esModule","default","./lib/CrossWindow.js","2","_typeof","Symbol","iterator","constructor","prototype","_defineProperties","target","props","descriptor","configurable","writable","toPrimitive","String","Number","TypeError","key","CommunicationManager","channel","cw","game","metadataManager","windowId","setupListeners","startPing","Constructor","protoProps","staticProps","_this","onmessage","event","data","action","sourceWindowId","postMessage","markWindowAsActive","targetWindowId","emit","_this2","setInterval","message","payload","3","_getBestWindow","_interopRequireDefault","_open","_CommunicationManager","_MetadataManager","_IntersectionDetector","CrossWindow","metadataKey","instance","events","concat","Date","now","Math","random","toString","substr","communicationManager","BroadcastChannel","intersectionDetector","open","bind","getBestWindow","getWindows","getCurrentWindows","getWindowMetadata","pollWindows","sendMessage","registerWindow","startHeartbeat","eventName","callback","push","callbacks","forEach","updateWindowMetadata","pingOtherWindows","setTimeout","removeInactiveWindows","deregisterWindow","./CommunicationManager.js","./IntersectionDetector.js","./MetadataManager.js","./getBestWindow.js","./open.js","4","_slicedToArray","arr","Array","isArray","l","next","done","minLen","_arrayLikeToArray","slice","name","from","test","len","arr2","IntersectionDetector","prevMetadata","startMetadataPolling","currentMetadata","hasMetadataChanged","checkForIntersections","allWindowsMetadata","JSON","parse","localStorage","getItem","entries","_ref","_ref2","metadata","isOverlapping","emitIntersectionEvent","calculateIntersection","metadata1","metadata2","position","x","size","width","y","height","x1","max","y1","min","intersectionArea","5","ownKeys","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","apply","_objectSpread","_toPropertyKey","getOwnPropertyDescriptors","defineProperties","MetadataManager","currentWindows","active","_this3","allWindows","hasOwnProperty","console","log","currentWindowMetadata","screenX","screenY","innerWidth","innerHeight","lastActive","setItem","stringify","_this4","timeout","currentTime","6","calculateEntryPosition","direction","bestWindowId","bestWindowMetadata","bestWindowSize","gameWidth","gameHeight","error","entityData","currentWindowPosition","currentWindowSize","minEdgeDistance","fallbackWindowId","minFallbackDistance","screenPosition","centerX","centerY","diffX","abs","diffY","Infinity","edgeDistance","targetWindowPosition","targetWindowSize","entryPosition","newEntryPosition","flashMessage","7","url","adjustCurrentWindow","availableScreenWidth","screen","availWidth","availableScreenHeight","availHeight","features","outerWidth","outerHeight","menubar","toolbar","location","status","scrollbars","resizable","title","toISOString","left","top","featuresStr","halfWidth","floor","halfHeight","offsetX","map","join","newWindow"],"mappings":"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"}