{"version":3,"sourceRoot":"../","sources":["./dist/crosswindow.js"],"sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.CW = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"CrossWindow\", {\n  enumerable: true,\n  get: function get() {\n    return _CrossWindow[\"default\"];\n  }\n});\nexports.createCrossWindow = createCrossWindow;\nvar _CrossWindow = _interopRequireDefault(require(\"./lib/CrossWindow.js\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction createCrossWindow() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return new _CrossWindow[\"default\"](options);\n}\n\n},{\"./lib/CrossWindow.js\":2}],2:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : String(i); }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n// CrossWindow.js - Marak Squires 2024\n// A class to manage communication and entity movement between multiple windows\n// Supports opening new windows, sending messages, and teleporting entities between windows\n// Also supports detecting and handling window intersections\nvar CrossWindow = exports[\"default\"] = /*#__PURE__*/function () {\n  function CrossWindow(game) {\n    var metadataKey = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'windowMetadata';\n    _classCallCheck(this, CrossWindow);\n    this.game = game;\n    this.metadataKey = metadataKey;\n    this.windowId = this.generateWindowId();\n    this.channel = new BroadcastChannel('crosswindow_channel');\n    this.events = {}; // Object to hold event callbacks\n    this.setupListeners();\n    this.registerWindow();\n    this.startMetadataPolling();\n  }\n  _createClass(CrossWindow, [{\n    key: \"generateWindowId\",\n    value: function generateWindowId() {\n      return \"\".concat(Date.now(), \"-\").concat(Math.random().toString(36).substr(2, 9));\n    }\n  }, {\n    key: \"startMetadataPolling\",\n    value: function startMetadataPolling() {\n      var _this = this;\n      this.prevMetadata = this.getWindowMetadata();\n      setInterval(function () {\n        var currentMetadata = _this.getWindowMetadata();\n        if (_this.hasMetadataChanged(_this.prevMetadata, currentMetadata)) {\n          _this.updateWindowMetadata(currentMetadata);\n          _this.checkForIntersections(currentMetadata);\n        }\n      }, 100); // Poll every 100ms\n    }\n  }, {\n    key: \"getWindowMetadata\",\n    value: function getWindowMetadata() {\n      return {\n        position: {\n          x: window.screenX,\n          y: window.screenY\n        },\n        size: {\n          width: window.innerWidth,\n          height: window.innerHeight\n        }\n      };\n    }\n  }, {\n    key: \"hasMetadataChanged\",\n    value: function hasMetadataChanged(prevMetadata, currentMetadata) {\n      return prevMetadata.position.x !== currentMetadata.position.x || prevMetadata.position.y !== currentMetadata.position.y || prevMetadata.size.width !== currentMetadata.size.width || prevMetadata.size.height !== currentMetadata.size.height;\n    }\n  }, {\n    key: \"updateWindowMetadata\",\n    value: function updateWindowMetadata() {\n      var metadata = {\n        position: {\n          x: window.screenX,\n          y: window.screenY\n        },\n        size: {\n          width: window.innerWidth,\n          height: window.innerHeight\n        },\n        lastActive: Date.now()\n      };\n      var allWindowsMetadata = JSON.parse(localStorage.getItem(this.metadataKey)) || {};\n      allWindowsMetadata[this.windowId] = metadata;\n      localStorage.setItem(this.metadataKey, JSON.stringify(allWindowsMetadata));\n    }\n  }, {\n    key: \"checkForIntersections\",\n    value: function checkForIntersections(currentMetadata) {\n      var _this2 = this;\n      var allWindowsMetadata = JSON.parse(localStorage.getItem(this.metadataKey)) || {};\n      Object.entries(allWindowsMetadata).forEach(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n          windowId = _ref2[0],\n          metadata = _ref2[1];\n        if (windowId !== _this2.windowId && _this2.isOverlapping(currentMetadata, metadata)) {\n          // Emit an 'intersecting' event to the overlapping window\n          _this2.emitIntersectionEvent(windowId, _this2.calculateIntersection(currentMetadata, metadata));\n        }\n      });\n    }\n  }, {\n    key: \"isOverlapping\",\n    value: function isOverlapping(metadata1, metadata2) {\n      return !(metadata2.position.x >= metadata1.position.x + metadata1.size.width || metadata2.position.x + metadata2.size.width <= metadata1.position.x || metadata2.position.y >= metadata1.position.y + metadata1.size.height || metadata2.position.y + metadata2.size.height <= metadata1.position.y);\n    }\n  }, {\n    key: \"calculateIntersection\",\n    value: function calculateIntersection(metadata1, metadata2) {\n      var x1 = Math.max(metadata1.position.x, metadata2.position.x);\n      var y1 = Math.max(metadata1.position.y, metadata2.position.y);\n      var x2 = Math.min(metadata1.position.x + metadata1.size.width, metadata2.position.x + metadata2.size.width);\n      var y2 = Math.min(metadata1.position.y + metadata1.size.height, metadata2.position.y + metadata2.size.height);\n      return {\n        position: {\n          x: x1,\n          y: y1\n        },\n        size: {\n          width: x2 - x1,\n          height: y2 - y1\n        }\n      };\n    }\n  }, {\n    key: \"emitIntersectionEvent\",\n    value: function emitIntersectionEvent(targetWindowId, intersectionArea) {\n      // console.log('postMessage intersecting', targetWindowId, intersectionArea)\n      this.channel.postMessage({\n        action: 'intersecting',\n        sourceWindowId: this.windowId,\n        targetWindowId: targetWindowId,\n        intersectionArea: intersectionArea\n      });\n    }\n  }, {\n    key: \"sendMessage\",\n    value: function sendMessage(targetWindowId, message) {\n      // Include both the target window ID and the message payload\n      console.log('postMessage message', targetWindowId, message);\n      this.channel.postMessage({\n        action: 'sendMessage',\n        targetWindowId: targetWindowId,\n        payload: message\n      });\n    }\n  }, {\n    key: \"on\",\n    value: function on(eventName, callback) {\n      if (!this.events[eventName]) {\n        this.events[eventName] = [];\n      }\n      this.events[eventName].push(callback);\n    }\n  }, {\n    key: \"emit\",\n    value: function emit(eventName, data) {\n      var callbacks = this.events[eventName];\n      if (callbacks) {\n        callbacks.forEach(function (callback) {\n          callback(data);\n        });\n      }\n    }\n  }, {\n    key: \"handleDirectMessage\",\n    value: function handleDirectMessage(data) {\n      // Implement handling of the direct message payload here\n      // This could involve creating entities, updating the game state, etc., based on the message content\n      console.log('Received direct message:', data);\n      this.emit('message', data);\n    }\n  }, {\n    key: \"open\",\n    value: function open(url) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var adjustCurrentWindow = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      // Check if URL is provided\n      if (!url) {\n        console.error('URL is required to open a new window.');\n        return;\n      }\n\n      // Default window features\n      var defaultFeatures = {\n        width: 600,\n        // Default width\n        height: 400,\n        // Default height\n        menubar: 'no',\n        toolbar: 'no',\n        location: 'no',\n        status: 'no',\n        scrollbars: 'yes',\n        resizable: 'yes',\n        title: new Date().toISOString(),\n        // Default title\n        top: window.screenY + 100,\n        // Default top position\n        left: window.screenX + 100 // Default left position\n      };\n\n      // Merge default features with custom options\n      var features = _objectSpread(_objectSpread({}, defaultFeatures), options);\n\n      // If adjustCurrentWindow is true, resize and reposition the current window\n      if (adjustCurrentWindow) {\n        window.resizeTo(window.outerWidth / 2, window.outerHeight / 2);\n        window.moveTo(features.left, features.top);\n        // Adjust new window's size to fill the empty space\n        features.width = window.outerWidth;\n        features.height = window.outerHeight;\n      }\n\n      // Convert features object to a comma-separated string\n      var featuresStr = Object.entries(features).map(function (_ref3) {\n        var _ref4 = _slicedToArray(_ref3, 2),\n          key = _ref4[0],\n          value = _ref4[1];\n        return \"\".concat(key, \"=\").concat(value);\n      }).join(',');\n\n      // Open a new window with the specified URL, name, and configured features\n      var newWindow = window.open(url, features.title, featuresStr);\n      if (newWindow) {\n        // If adjustCurrentWindow is true, position the new window to fill the empty space\n        if (adjustCurrentWindow) {\n          newWindow.moveTo(window.screenX + window.outerWidth, window.screenY);\n        }\n        // Return the reference to the new window for further use\n        return newWindow;\n      } else {\n        console.error('Failed to open a new window. Please check browser popup settings.');\n      }\n    }\n  }, {\n    key: \"registerWindow\",\n    value: function registerWindow() {\n      this.updateWindowMetadata();\n      this.pingOtherWindows();\n    }\n  }, {\n    key: \"pingOtherWindows\",\n    value: function pingOtherWindows() {\n      var _this3 = this;\n      // Broadcast a ping message to all windows\n      this.channel.postMessage({\n        action: 'ping',\n        sourceWindowId: this.windowId\n      });\n\n      // Set a timeout to check for windows that haven't responded\n      setTimeout(function () {\n        _this3.removeInactiveWindows();\n      }, 5000); // Adjust the timeout duration as needed\n    }\n  }, {\n    key: \"setupListeners\",\n    value: function setupListeners() {\n      var _this4 = this;\n      this.channel.onmessage = function (event) {\n        var data = event.data;\n        // Handle incoming messages\n        if (data.action === 'createEntity' && data.entities) {\n          data.entities.forEach(function (entity) {\n            return _this4.game.createEntity(entity);\n          });\n        } else if (data.action === 'ping' && data.sourceWindowId !== _this4.windowId) {\n          // Respond to ping with pong\n          _this4.channel.postMessage({\n            action: 'pong',\n            sourceWindowId: _this4.windowId\n          });\n        } else if (data.action === 'pong' && data.sourceWindowId !== _this4.windowId) {\n          // Mark the window as active\n          _this4.markWindowAsActive(data.sourceWindowId);\n        } else if (data.action === 'sendMessage' && data.targetWindowId === _this4.windowId) {\n          _this4.handleDirectMessage(data);\n        } else if (data.action === 'intersecting' && data.sourceWindowId !== _this4.windowId) {\n          // Handle intersection event\n          _this4.emit('message', data);\n        }\n      };\n    }\n  }, {\n    key: \"markWindowAsActive\",\n    value: function markWindowAsActive(windowId) {\n      // Update the lastActive timestamp for the window in localStorage\n      var allWindowsMetadata = JSON.parse(localStorage.getItem(this.metadataKey)) || {};\n      if (allWindowsMetadata[windowId]) {\n        allWindowsMetadata[windowId].lastActive = Date.now();\n        localStorage.setItem(this.metadataKey, JSON.stringify(allWindowsMetadata));\n      }\n    }\n  }, {\n    key: \"removeInactiveWindows\",\n    value: function removeInactiveWindows() {\n      var allWindowsMetadata = JSON.parse(localStorage.getItem(this.metadataKey)) || {};\n      var currentTime = Date.now();\n      Object.entries(allWindowsMetadata).forEach(function (_ref5) {\n        var _ref6 = _slicedToArray(_ref5, 2),\n          windowId = _ref6[0],\n          metadata = _ref6[1];\n        // Consider a window inactive if it hasn't responded to the ping within the timeout\n        if (currentTime - metadata.lastActive > 5000) {\n          // 5-second timeout\n          delete allWindowsMetadata[windowId];\n        }\n      });\n      localStorage.setItem(this.metadataKey, JSON.stringify(allWindowsMetadata));\n    }\n  }, {\n    key: \"teleportEntities\",\n    value: function teleportEntities(entityIds, targetWindowId) {\n      var entitiesToTeleport = this.game.entities.filter(function (entity) {\n        return entityIds.includes(entity.id);\n      });\n      if (entitiesToTeleport.length > 0) {\n        this.channel.postMessage({\n          action: 'createEntity',\n          targetWindowId: targetWindowId,\n          entities: entitiesToTeleport\n        });\n      }\n    }\n  }, {\n    key: \"deregisterWindow\",\n    value: function deregisterWindow() {\n      var allWindowsMetadata = JSON.parse(localStorage.getItem(this.metadataKey)) || {};\n      delete allWindowsMetadata[this.windowId];\n      localStorage.setItem(this.metadataKey, JSON.stringify(allWindowsMetadata));\n      // Optionally, broadcast deregistration if needed for cleanup in other windows\n    }\n  }, {\n    key: \"getBestWindow\",\n    value: function getBestWindow(entityData) {\n      var _this5 = this;\n      var direction = this.determineCardinalDirection(entityData.screenPosition);\n      var allWindowsMetadata = JSON.parse(localStorage.getItem(this.metadataKey)) || {};\n      if (Object.keys(allWindowsMetadata).length === 0) {\n        //alert('no other windows found');\n        game.flashMessage('no other windows found');\n      }\n      var bestWindowId = null;\n      var minDistance = Infinity;\n      //game.flashMessage(Object.keys(allWindowsMetadata).length)\n      Object.entries(allWindowsMetadata).forEach(function (_ref7) {\n        var _ref8 = _slicedToArray(_ref7, 2),\n          windowId = _ref8[0],\n          metadata = _ref8[1];\n        bestWindowId = windowId; // for now\n        if (windowId !== _this5.windowId) {\n          // Skip the current window\n          var distance = _this5.calculateDistance(entityData.screenPosition, metadata.position);\n          if (distance < minDistance) {\n            minDistance = distance;\n            bestWindowId = windowId;\n          }\n        }\n      });\n      if (bestWindowId) {\n        // Return a window object with a .postMessage() method for the existing best window\n        return {\n          postMessage: function postMessage(data) {\n            console.log('calling internal bestWindow.postMessage', bestWindowId, data);\n\n            // Calculate the entry position based on the exit direction and position\n            var newEntryPosition = _this5.calculateEntryPosition(direction, data.position);\n            data.position = newEntryPosition;\n            console.log(\"SENDING NEW POST\", data);\n            _this5.channel.postMessage({\n              action: 'sendMessage',\n              targetWindowId: bestWindowId,\n              payload: data\n            });\n          }\n        };\n      } else {\n        game.flashMessage('could not find any windows');\n        // Remark: Disabled auto-opening windows ( for now )\n        return;\n        // No suitable window found, create a new one and return a window object for it\n        var newWindow = this.open('new_window_url.html', this.calculateWindowFeaturesForDirection(direction)); // Adjust URL and options as needed\n        if (newWindow) {\n          return {\n            postMessage: function postMessage(message) {\n              _this5.channel.postMessage({\n                action: 'sendMessage',\n                // TODO: needs id? or auto-register?\n                targetWindowId: _this5.generateWindowId(),\n                // Assuming new window gets a new ID\n                payload: data\n              });\n            }\n          };\n        }\n      }\n    }\n  }, {\n    key: \"calculateEntryPosition\",\n    value: function calculateEntryPosition(direction, position) {\n      // TODO: Implement logic to calculate the entry position based on the exit direction and position\n      position.x = -100;\n      position.y = 0;\n      return position;\n    }\n  }, {\n    key: \"calculateDistance\",\n    value: function calculateDistance(point1, point2) {\n      var dx = point1.x - point2.x;\n      var dy = point1.y - point2.y;\n      return Math.sqrt(dx * dx + dy * dy);\n    }\n  }, {\n    key: \"determineCardinalDirection\",\n    value: function determineCardinalDirection(screenPosition) {\n      // Use the screenPosition to determine the cardinal direction\n      // This could be a simple check of x and y coordinates relative to the center of the screen\n      var centerX = window.innerWidth / 2;\n      var centerY = window.innerHeight / 2;\n      if (screenPosition.x < centerX && screenPosition.y < centerY) return 'NW';\n      if (screenPosition.x >= centerX && screenPosition.y < centerY) return 'NE';\n      if (screenPosition.x >= centerX && screenPosition.y >= centerY) return 'SE';\n      if (screenPosition.x < centerX && screenPosition.y >= centerY) return 'SW';\n      // Add more granular direction checks if needed\n    }\n  }, {\n    key: \"calculateWindowFeaturesForDirection\",\n    value: function calculateWindowFeaturesForDirection(direction) {\n      // Implement logic to calculate window features (position, size) based on the exit direction\n      // Return an object with properties suitable for the 'open' method\n    }\n  }]);\n  return CrossWindow;\n}();\n\n},{}]},{},[1])(1)\n});\n"],"names":["f","exports","module","define","amd","window","global","self","this","CW","r","e","n","t","o","i","c","require","u","a","Error","code","p","call","length","1","Object","defineProperty","value","enumerable","get","_CrossWindow","createCrossWindow","options","arguments","undefined","obj","__esModule","default","./lib/CrossWindow.js","2","_typeof","Symbol","iterator","constructor","prototype","ownKeys","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","push","apply","_objectSpread","forEach","key","_toPropertyKey","configurable","writable","getOwnPropertyDescriptors","defineProperties","_slicedToArray","arr","Array","isArray","l","next","done","minLen","_arrayLikeToArray","toString","slice","name","from","test","TypeError","len","arr2","_defineProperties","target","props","descriptor","toPrimitive","String","Number","CrossWindow","game","metadataKey","instance","Constructor","windowId","generateWindowId","channel","BroadcastChannel","events","setupListeners","registerWindow","startMetadataPolling","protoProps","staticProps","concat","Date","now","Math","random","substr","_this","prevMetadata","getWindowMetadata","setInterval","currentMetadata","hasMetadataChanged","updateWindowMetadata","checkForIntersections","position","x","screenX","y","screenY","size","width","innerWidth","height","innerHeight","metadata","lastActive","allWindowsMetadata","JSON","parse","localStorage","getItem","setItem","stringify","_this2","entries","_ref","_ref2","isOverlapping","emitIntersectionEvent","calculateIntersection","metadata1","metadata2","x1","max","y1","min","targetWindowId","intersectionArea","postMessage","action","sourceWindowId","message","console","log","payload","eventName","callback","data","callbacks","emit","url","adjustCurrentWindow","features","menubar","toolbar","location","status","scrollbars","resizable","title","toISOString","top","left","featuresStr","resizeTo","outerWidth","outerHeight","moveTo","map","_ref3","_ref4","join","newWindow","open","error","pingOtherWindows","_this3","setTimeout","removeInactiveWindows","_this4","onmessage","event","entities","entity","createEntity","markWindowAsActive","handleDirectMessage","currentTime","_ref5","_ref6","entityIds","entitiesToTeleport","includes","id","entityData","_this5","direction","determineCardinalDirection","screenPosition","bestWindowId","flashMessage","minDistance","Infinity","_ref7","_ref8","distance","calculateDistance","newEntryPosition","calculateEntryPosition","point1","point2","dx","dy","sqrt","centerX","centerY"],"mappings":"AAAA,CAAA,SAAUA,GAAuB,UAAjB,OAAOC,SAAoC,aAAhB,OAAOC,OAAsBA,OAAOD,QAAQD,EAAE,EAA0B,YAAhB,OAAOG,QAAqBA,OAAOC,IAAKD,OAAO,GAAGH,CAAC,GAAgC,aAAhB,OAAOK,OAAwBA,OAA+B,aAAhB,OAAOC,OAAwBA,OAA6B,aAAd,OAAOC,KAAsBA,KAAYC,MAAOC,GAAKT,EAAE,CAAG,EAAE,WAAqC,OAAmB,SAASU,EAAEC,EAAEC,EAAEC,GAAG,SAASC,EAAEC,EAAEf,GAAG,GAAG,CAACY,EAAEG,GAAG,CAAC,GAAG,CAACJ,EAAEI,GAAG,CAAC,IAAIC,EAAE,YAAY,OAAOC,SAASA,QAAQ,GAAG,CAACjB,GAAGgB,EAAE,OAAOA,EAAED,EAAE,CAAA,CAAE,EAAE,GAAGG,EAAE,OAAOA,EAAEH,EAAE,CAAA,CAAE,EAAgD,MAA1CI,EAAE,IAAIC,MAAM,uBAAuBL,EAAE,GAAG,GAAUM,KAAK,mBAAmBF,CAAC,CAAKG,EAAEV,EAAEG,GAAG,CAACd,QAAQ,EAAE,EAAEU,EAAEI,GAAG,GAAGQ,KAAKD,EAAErB,QAAQ,SAASS,GAAoB,OAAOI,EAAlBH,EAAEI,GAAG,GAAGL,IAAeA,CAAC,CAAC,EAAEY,EAAEA,EAAErB,QAAQS,EAAEC,EAAEC,EAAEC,CAAC,CAAC,CAAC,OAAOD,EAAEG,GAAGd,OAAO,CAAC,IAAI,IAAIiB,EAAE,YAAY,OAAOD,SAASA,QAAQF,EAAE,EAAEA,EAAEF,EAAEW,OAAOT,CAAC,GAAGD,EAAED,EAAEE,EAAE,EAAE,OAAOD,CAAC,EAAc,CAACW,EAAE,CAAC,SAASR,EAAQf,EAAOD,GACl1B,aAEAyB,OAAOC,eAAe1B,EAAS,aAAc,CAC3C2B,MAAO,CAAA,CACT,CAAC,EACDF,OAAOC,eAAe1B,EAAS,cAAe,CAC5C4B,WAAY,CAAA,EACZC,IAAK,WACH,OAAOC,EAAsB,OAC/B,CACF,CAAC,EACD9B,EAAQ+B,kBAGR,WACE,IAAIC,EAA6B,EAAnBC,UAAUV,QAA+BW,KAAAA,IAAjBD,UAAU,GAAmBA,UAAU,GAAK,GAClF,OAAO,IAAIH,EAAsB,QAAEE,CAAO,CAC5C,EALA,IAAIF,GAC4BK,EADUnB,EAAQ,sBAAsB,IACnBmB,EAAIC,WAAaD,EAAM,CAAEE,QAAWF,CAAI,CAM7F,EAAE,CAACG,uBAAuB,CAAC,GAAGC,EAAE,CAAC,SAASvB,EAAQf,EAAOD,GACzD,aAMA,SAASwC,EAAQ3B,GAAgC,OAAO2B,EAAU,YAAc,OAAOC,QAAU,UAAY,OAAOA,OAAOC,SAAW,SAAU7B,GAAK,OAAO,OAAOA,CAAG,EAAI,SAAUA,GAAK,OAAOA,GAAK,YAAc,OAAO4B,QAAU5B,EAAE8B,cAAgBF,QAAU5B,IAAM4B,OAAOG,UAAY,SAAW,OAAO/B,CAAG,GAAWA,CAAC,CAAG,CAC7T,SAASgC,EAAQnC,EAAGD,GAAK,IAAgEI,EAA5DD,EAAIa,OAAOqB,KAAKpC,CAAC,EAAsM,OAA/Le,OAAOsB,wBAA6BlC,EAAIY,OAAOsB,sBAAsBrC,CAAC,EAAGD,IAAMI,EAAIA,EAAEmC,OAAO,SAAUvC,GAAK,OAAOgB,OAAOwB,yBAAyBvC,EAAGD,CAAC,EAAEmB,UAAY,CAAC,GAAIhB,EAAEsC,KAAKC,MAAMvC,EAAGC,CAAC,GAAYD,CAAG,CAC9P,SAASwC,EAAc1C,GAAK,IAAK,IAAID,EAAI,EAAGA,EAAIwB,UAAUV,OAAQd,CAAC,GAAI,CAAE,IAAIG,EAAI,MAAQqB,UAAUxB,GAAKwB,UAAUxB,GAAK,GAAIA,EAAI,EAAIoC,EAAQpB,OAAOb,CAAC,EAAG,CAAA,CAAE,EAAEyC,QAAQ,SAAU5C,GAC5K,IAAyB0B,EAAUR,EAAVQ,EADwKzB,EAC9JiB,EADoKf,EACzK0C,EADsK7C,IACxJ6C,EAAMC,EAAeD,CAAG,KAAcnB,EAAOV,OAAOC,eAAeS,EAAKmB,EAAK,CAAE3B,MAAOA,EAAOC,WAAY,CAAA,EAAM4B,aAAc,CAAA,EAAMC,SAAU,CAAA,CAAK,CAAC,EAAYtB,EAAImB,GAAO3B,CADR,CAAC,EAAIF,OAAOiC,0BAA4BjC,OAAOkC,iBAAiBjD,EAAGe,OAAOiC,0BAA0B9C,CAAC,CAAC,EAAIiC,EAAQpB,OAAOb,CAAC,CAAC,EAAEyC,QAAQ,SAAU5C,GAAKgB,OAAOC,eAAehB,EAAGD,EAAGgB,OAAOwB,yBAAyBrC,EAAGH,CAAC,CAAC,CAAG,CAAC,CAAG,CAAE,OAAOC,CAAG,CAEtb,SAASkD,EAAeC,EAAK/C,GAAK,OAKlC,SAAyB+C,GAAO,GAAIC,MAAMC,QAAQF,CAAG,EAAG,OAAOA,CAAK,EALXA,CAAG,GAI5D,SAA+BpD,EAAGuD,GAAK,IAAIpD,EAAI,MAAQH,EAAI,KAAO,aAAe,OAAOgC,QAAUhC,EAAEgC,OAAOC,WAAajC,EAAE,cAAe,GAAI,MAAQG,EAAG,CAAE,IAAIF,EAAGC,EAAGG,EAAGG,EAAGC,EAAI,GAAInB,EAAI,CAAA,EAAIc,EAAI,CAAA,EAAI,IAAM,GAAIC,GAAKF,EAAIA,EAAEU,KAAKb,CAAC,GAAGwD,KAAM,IAAMD,EAAG,CAAE,GAAIvC,OAAOb,CAAC,IAAMA,EAAG,OAAQb,EAAI,CAAA,CAAI,MAAO,KAAO,EAAEA,GAAKW,EAAII,EAAEQ,KAAKV,CAAC,GAAGsD,QAAUhD,EAAEgC,KAAKxC,EAAEiB,KAAK,EAAGT,EAAEK,SAAWyC,GAAIjE,EAAI,CAAA,GAAiK,CAA1J,MAAOU,GAAKI,EAAI,CAAA,EAAIF,EAAIF,CAAG,CAAE,QAAU,IAAM,GAAI,CAACV,GAAK,MAAQa,EAAU,SAAMK,EAAIL,EAAU,OAAE,EAAGa,OAAOR,CAAC,IAAMA,GAAI,MAAoC,CAA1B,QAAU,GAAIJ,EAAG,MAAMF,CAAG,CAAE,CAAE,OAAOO,CAAG,CAAE,EAJlc2C,EAAK/C,CAAC,GAE7F,SAAqCD,EAAGsD,GAAU,IAAoFxD,EAApF,GAAKE,EAAW,MAAiB,UAAb,OAAOA,EAAuBuD,EAAkBvD,EAAGsD,CAAM,EAAkI,SAAlCxD,EAA3B,YAA9DA,EAAIc,OAAOmB,UAAUyB,SAAS/C,KAAKT,CAAC,EAAEyD,MAAM,EAAG,CAAC,CAAC,IAAyBzD,EAAE8B,YAAiB9B,EAAE8B,YAAY4B,KAAU5D,IAAqB,QAANA,EAAoBmD,MAAMU,KAAK3D,CAAC,EAAa,cAANF,GAAqB,2CAA2C8D,KAAK9D,CAAC,EAAUyD,EAAkBvD,EAAGsD,CAAM,EAA/G,KAAA,CAAkH,EAFjSN,EAAK/C,CAAC,GACpI,WAA8B,MAAM,IAAI4D,UAAU,2IAA2I,CAAG,EADtC,CAAG,CAG7J,SAASN,EAAkBP,EAAKc,IAAkB,MAAPA,GAAeA,EAAMd,EAAItC,UAAQoD,EAAMd,EAAItC,QAAQ,IAAK,IAAIT,EAAI,EAAG8D,EAAO,IAAId,MAAMa,CAAG,EAAG7D,EAAI6D,EAAK7D,CAAC,GAAI8D,EAAK9D,GAAK+C,EAAI/C,GAAI,OAAO8D,CAAM,CAIlL,SAASC,EAAkBC,EAAQC,GAAS,IAAK,IAAIjE,EAAI,EAAGA,EAAIiE,EAAMxD,OAAQT,CAAC,GAAI,CAAE,IAAIkE,EAAaD,EAAMjE,GAAIkE,EAAWpD,WAAaoD,EAAWpD,YAAc,CAAA,EAAOoD,EAAWxB,aAAe,CAAA,EAAU,UAAWwB,IAAYA,EAAWvB,SAAW,CAAA,GAAMhC,OAAOC,eAAeoD,EAAQvB,EAAeyB,EAAW1B,GAAG,EAAG0B,CAAU,CAAG,CAAE,CAE5U,SAASzB,EAAe3C,GAASE,EACjC,SAAsBF,EAAGH,GAAK,GAAI,UAAY+B,EAAQ5B,CAAC,GAAK,CAACA,EAAG,OAAOA,EAAG,IAAIF,EAAIE,EAAE6B,OAAOwC,aAAc,GAAI,KAAA,IAAWvE,EAAqJ,OAAQ,WAAaD,EAAIyE,OAASC,QAAQvE,CAAC,EAAvLE,EAAIJ,EAAEY,KAAKV,EAAGH,GAAK,SAAS,EAAG,GAAI,UAAY+B,EAAQ1B,CAAC,EAAG,OAAOA,EAAG,MAAM,IAAI4D,UAAU,8CAA8C,CAAmD,EADzQ9D,EAAG,QAAQ,EAAG,MAAO,UAAY4B,EAAQ1B,CAAC,EAAIA,EAAIoE,OAAOpE,CAAC,CAAG,CAjB/GW,OAAOC,eAAe1B,EAAS,aAAc,CAC3C2B,MAAO,CAAA,CACT,CAAC,EACD3B,EAAiB,QAAI,KAAA,EAoBHA,EAAiB,QAAiB,WAClD,SAASoF,EAAYC,GACnB,IAAIC,EAAiC,EAAnBrD,UAAUV,QAA+BW,KAAAA,IAAjBD,UAAU,GAAmBA,UAAU,GAAK,iBAXjEsD,EAYLhF,KAZeiF,EAYTJ,EAZwB,GAAI,EAAEG,aAAoBC,GAAgB,MAAM,IAAId,UAAU,mCAAmC,EAa/InE,KAAK8E,KAAOA,EACZ9E,KAAK+E,YAAcA,EACnB/E,KAAKkF,SAAWlF,KAAKmF,iBAAiB,EACtCnF,KAAKoF,QAAU,IAAIC,iBAAiB,qBAAqB,EACzDrF,KAAKsF,OAAS,GACdtF,KAAKuF,eAAe,EACpBvF,KAAKwF,eAAe,EACpBxF,KAAKyF,qBAAqB,CAC5B,CAnBF,IAAsBR,EAAaS,EAAYC,EAsa7C,OAtaoBV,EAoBPJ,GApBoBa,EAoBP,CAAC,CACzB3C,IAAK,mBACL3B,MAAO,WACL,MAAO,GAAGwE,OAAOC,KAAKC,IAAI,EAAG,GAAG,EAAEF,OAAOG,KAAKC,OAAO,EAAElC,SAAS,EAAE,EAAEmC,OAAO,EAAG,CAAC,CAAC,CAClF,CACF,EAAG,CACDlD,IAAK,uBACL3B,MAAO,WACL,IAAI8E,EAAQlG,KACZA,KAAKmG,aAAenG,KAAKoG,kBAAkB,EAC3CC,YAAY,WACV,IAAIC,EAAkBJ,EAAME,kBAAkB,EAC1CF,EAAMK,mBAAmBL,EAAMC,aAAcG,CAAe,IAC9DJ,EAAMM,qBAAqBF,CAAe,EAC1CJ,EAAMO,sBAAsBH,CAAe,EAE/C,EAAG,GAAG,CACR,CACF,EAAG,CACDvD,IAAK,oBACL3B,MAAO,WACL,MAAO,CACLsF,SAAU,CACRC,EAAG9G,OAAO+G,QACVC,EAAGhH,OAAOiH,OACZ,EACAC,KAAM,CACJC,MAAOnH,OAAOoH,WACdC,OAAQrH,OAAOsH,WACjB,CACF,CACF,CACF,EAAG,CACDpE,IAAK,qBACL3B,MAAO,SAA4B+E,EAAcG,GAC/C,OAAOH,EAAaO,SAASC,IAAML,EAAgBI,SAASC,GAAKR,EAAaO,SAASG,IAAMP,EAAgBI,SAASG,GAAKV,EAAaY,KAAKC,QAAUV,EAAgBS,KAAKC,OAASb,EAAaY,KAAKG,SAAWZ,EAAgBS,KAAKG,MACzO,CACF,EAAG,CACDnE,IAAK,uBACL3B,MAAO,WACL,IAAIgG,EAAW,CACbV,SAAU,CACRC,EAAG9G,OAAO+G,QACVC,EAAGhH,OAAOiH,OACZ,EACAC,KAAM,CACJC,MAAOnH,OAAOoH,WACdC,OAAQrH,OAAOsH,WACjB,EACAE,WAAYxB,KAAKC,IAAI,CACvB,EACIwB,EAAqBC,KAAKC,MAAMC,aAAaC,QAAQ1H,KAAK+E,WAAW,CAAC,GAAK,GAC/EuC,EAAmBtH,KAAKkF,UAAYkC,EACpCK,aAAaE,QAAQ3H,KAAK+E,YAAawC,KAAKK,UAAUN,CAAkB,CAAC,CAC3E,CACF,EAAG,CACDvE,IAAK,wBACL3B,MAAO,SAA+BkF,GACpC,IAAIuB,EAAS7H,KACTsH,EAAqBC,KAAKC,MAAMC,aAAaC,QAAQ1H,KAAK+E,WAAW,CAAC,GAAK,GAC/E7D,OAAO4G,QAAQR,CAAkB,EAAExE,QAAQ,SAAUiF,GACnD,IAAIC,EAAQ3E,EAAe0E,EAAM,CAAC,EAChC7C,EAAW8C,EAAM,GACjBZ,EAAWY,EAAM,GACf9C,IAAa2C,EAAO3C,UAAY2C,EAAOI,cAAc3B,EAAiBc,CAAQ,GAEhFS,EAAOK,sBAAsBhD,EAAU2C,EAAOM,sBAAsB7B,EAAiBc,CAAQ,CAAC,CAElG,CAAC,CACH,CACF,EAAG,CACDrE,IAAK,gBACL3B,MAAO,SAAuBgH,EAAWC,GACvC,MAAO,EAAEA,EAAU3B,SAASC,GAAKyB,EAAU1B,SAASC,EAAIyB,EAAUrB,KAAKC,OAASqB,EAAU3B,SAASC,EAAI0B,EAAUtB,KAAKC,OAASoB,EAAU1B,SAASC,GAAK0B,EAAU3B,SAASG,GAAKuB,EAAU1B,SAASG,EAAIuB,EAAUrB,KAAKG,QAAUmB,EAAU3B,SAASG,EAAIwB,EAAUtB,KAAKG,QAAUkB,EAAU1B,SAASG,EACpS,CACF,EAAG,CACD9D,IAAK,wBACL3B,MAAO,SAA+BgH,EAAWC,GAC/C,IAAIC,EAAKvC,KAAKwC,IAAIH,EAAU1B,SAASC,EAAG0B,EAAU3B,SAASC,CAAC,EACxD6B,EAAKzC,KAAKwC,IAAIH,EAAU1B,SAASG,EAAGwB,EAAU3B,SAASG,CAAC,EAG5D,MAAO,CACLH,SAAU,CACRC,EAAG2B,EACHzB,EAAG2B,CACL,EACAzB,KAAM,CACJC,MARKjB,KAAK0C,IAAIL,EAAU1B,SAASC,EAAIyB,EAAUrB,KAAKC,MAAOqB,EAAU3B,SAASC,EAAI0B,EAAUtB,KAAKC,KAAK,EAQ1FsB,EACZpB,OARKnB,KAAK0C,IAAIL,EAAU1B,SAASG,EAAIuB,EAAUrB,KAAKG,OAAQmB,EAAU3B,SAASG,EAAIwB,EAAUtB,KAAKG,MAAM,EAQ3FsB,CACf,CACF,CACF,CACF,EAAG,CACDzF,IAAK,wBACL3B,MAAO,SAA+BsH,EAAgBC,GAEpD3I,KAAKoF,QAAQwD,YAAY,CACvBC,OAAQ,eACRC,eAAgB9I,KAAKkF,SACrBwD,eAAgBA,EAChBC,iBAAkBA,CACpB,CAAC,CACH,CACF,EAAG,CACD5F,IAAK,cACL3B,MAAO,SAAqBsH,EAAgBK,GAE1CC,QAAQC,IAAI,sBAAuBP,EAAgBK,CAAO,EAC1D/I,KAAKoF,QAAQwD,YAAY,CACvBC,OAAQ,cACRH,eAAgBA,EAChBQ,QAASH,CACX,CAAC,CACH,CACF,EAAG,CACDhG,IAAK,KACL3B,MAAO,SAAY+H,EAAWC,GACvBpJ,KAAKsF,OAAO6D,KACfnJ,KAAKsF,OAAO6D,GAAa,IAE3BnJ,KAAKsF,OAAO6D,GAAWxG,KAAKyG,CAAQ,CACtC,CACF,EAAG,CACDrG,IAAK,OACL3B,MAAO,SAAc+H,EAAWE,GAC1BC,EAAYtJ,KAAKsF,OAAO6D,GACxBG,GACFA,EAAUxG,QAAQ,SAAUsG,GAC1BA,EAASC,CAAI,CACf,CAAC,CAEL,CACF,EAAG,CACDtG,IAAK,sBACL3B,MAAO,SAA6BiI,GAGlCL,QAAQC,IAAI,2BAA4BI,CAAI,EAC5CrJ,KAAKuJ,KAAK,UAAWF,CAAI,CAC3B,CACF,EAAG,CACDtG,IAAK,OACL3B,MAAO,SAAcoI,GACnB,IAAI/H,EAA6B,EAAnBC,UAAUV,QAA+BW,KAAAA,IAAjBD,UAAU,GAAmBA,UAAU,GAAK,GAC9E+H,EAAyC,EAAnB/H,UAAUV,QAA+BW,KAAAA,IAAjBD,UAAU,IAAmBA,UAAU,GAEzF,GAAK8H,EAAL,CAMA,IAmBIE,EAAW7G,EAAcA,EAAc,GAnBrB,CACpBmE,MAAO,IAEPE,OAAQ,IAERyC,QAAS,KACTC,QAAS,KACTC,SAAU,KACVC,OAAQ,KACRC,WAAY,MACZC,UAAW,MACXC,OAAO,IAAIpE,MAAOqE,YAAY,EAE9BC,IAAKtK,OAAOiH,QAAU,IAEtBsD,KAAMvK,OAAO+G,QAAU,GACzB,CAG8D,EAAGnF,CAAO,EAYpE4I,GATAZ,IACF5J,OAAOyK,SAASzK,OAAO0K,WAAa,EAAG1K,OAAO2K,YAAc,CAAC,EAC7D3K,OAAO4K,OAAOf,EAASU,KAAMV,EAASS,GAAG,EAEzCT,EAAS1C,MAAQnH,OAAO0K,WACxBb,EAASxC,OAASrH,OAAO2K,aAITtJ,OAAO4G,QAAQ4B,CAAQ,EAAEgB,IAAI,SAAUC,GACvD,IAAIC,EAAQvH,EAAesH,EAAO,CAAC,EACjC5H,EAAM6H,EAAM,GACZxJ,EAAQwJ,EAAM,GAChB,MAAO,GAAGhF,OAAO7C,EAAK,GAAG,EAAE6C,OAAOxE,CAAK,CACzC,CAAC,EAAEyJ,KAAK,GAAG,GAGPC,EAAYjL,OAAOkL,KAAKvB,EAAKE,EAASO,MAAOI,CAAW,EAC5D,GAAIS,EAMF,OAJIrB,GACFqB,EAAUL,OAAO5K,OAAO+G,QAAU/G,OAAO0K,WAAY1K,OAAOiH,OAAO,EAG9DgE,EAEP9B,QAAQgC,MAAM,mEAAmE,CAnDnF,MAFEhC,QAAQgC,MAAM,uCAAuC,CAuDzD,CACF,EAAG,CACDjI,IAAK,iBACL3B,MAAO,WACLpB,KAAKwG,qBAAqB,EAC1BxG,KAAKiL,iBAAiB,CACxB,CACF,EAAG,CACDlI,IAAK,mBACL3B,MAAO,WACL,IAAI8J,EAASlL,KAEbA,KAAKoF,QAAQwD,YAAY,CACvBC,OAAQ,OACRC,eAAgB9I,KAAKkF,QACvB,CAAC,EAGDiG,WAAW,WACTD,EAAOE,sBAAsB,CAC/B,EAAG,GAAI,CACT,CACF,EAAG,CACDrI,IAAK,iBACL3B,MAAO,WACL,IAAIiK,EAASrL,KACbA,KAAKoF,QAAQkG,UAAY,SAAUC,GAC7BlC,EAAOkC,EAAMlC,KAEG,iBAAhBA,EAAKR,QAA6BQ,EAAKmC,SACzCnC,EAAKmC,SAAS1I,QAAQ,SAAU2I,GAC9B,OAAOJ,EAAOvG,KAAK4G,aAAaD,CAAM,CACxC,CAAC,EACwB,SAAhBpC,EAAKR,QAAqBQ,EAAKP,iBAAmBuC,EAAOnG,SAElEmG,EAAOjG,QAAQwD,YAAY,CACzBC,OAAQ,OACRC,eAAgBuC,EAAOnG,QACzB,CAAC,EACwB,SAAhBmE,EAAKR,QAAqBQ,EAAKP,iBAAmBuC,EAAOnG,SAElEmG,EAAOM,mBAAmBtC,EAAKP,cAAc,EACpB,gBAAhBO,EAAKR,QAA4BQ,EAAKX,iBAAmB2C,EAAOnG,SACzEmG,EAAOO,oBAAoBvC,CAAI,EACN,iBAAhBA,EAAKR,QAA6BQ,EAAKP,iBAAmBuC,EAAOnG,UAE1EmG,EAAO9B,KAAK,UAAWF,CAAI,CAE/B,CACF,CACF,EAAG,CACDtG,IAAK,qBACL3B,MAAO,SAA4B8D,GAEjC,IAAIoC,EAAqBC,KAAKC,MAAMC,aAAaC,QAAQ1H,KAAK+E,WAAW,CAAC,GAAK,GAC3EuC,EAAmBpC,KACrBoC,EAAmBpC,GAAUmC,WAAaxB,KAAKC,IAAI,EACnD2B,aAAaE,QAAQ3H,KAAK+E,YAAawC,KAAKK,UAAUN,CAAkB,CAAC,EAE7E,CACF,EAAG,CACDvE,IAAK,wBACL3B,MAAO,WACL,IAAIkG,EAAqBC,KAAKC,MAAMC,aAAaC,QAAQ1H,KAAK+E,WAAW,CAAC,GAAK,GAC3E8G,EAAchG,KAAKC,IAAI,EAC3B5E,OAAO4G,QAAQR,CAAkB,EAAExE,QAAQ,SAAUgJ,GACnD,IAAIC,EAAQ1I,EAAeyI,EAAO,CAAC,EACjC5G,EAAW6G,EAAM,GACjB3E,EAAW2E,EAAM,GAEqB,IAApCF,EAAczE,EAASC,YAEzB,OAAOC,EAAmBpC,EAE9B,CAAC,EACDuC,aAAaE,QAAQ3H,KAAK+E,YAAawC,KAAKK,UAAUN,CAAkB,CAAC,CAC3E,CACF,EAAG,CACDvE,IAAK,mBACL3B,MAAO,SAA0B4K,EAAWtD,GAC1C,IAAIuD,EAAqBjM,KAAK8E,KAAK0G,SAAS/I,OAAO,SAAUgJ,GAC3D,OAAOO,EAAUE,SAAST,EAAOU,EAAE,CACrC,CAAC,EAC+B,EAA5BF,EAAmBjL,QACrBhB,KAAKoF,QAAQwD,YAAY,CACvBC,OAAQ,eACRH,eAAgBA,EAChB8C,SAAUS,CACZ,CAAC,CAEL,CACF,EAAG,CACDlJ,IAAK,mBACL3B,MAAO,WACL,IAAIkG,EAAqBC,KAAKC,MAAMC,aAAaC,QAAQ1H,KAAK+E,WAAW,CAAC,GAAK,GAC/E,OAAOuC,EAAmBtH,KAAKkF,UAC/BuC,aAAaE,QAAQ3H,KAAK+E,YAAawC,KAAKK,UAAUN,CAAkB,CAAC,CAE3E,CACF,EAAG,CACDvE,IAAK,gBACL3B,MAAO,SAAuBgL,GAC5B,IAAIC,EAASrM,KACTsM,EAAYtM,KAAKuM,2BAA2BH,EAAWI,cAAc,EACrElF,EAAqBC,KAAKC,MAAMC,aAAaC,QAAQ1H,KAAK+E,WAAW,CAAC,GAAK,GAK3E0H,GAJ2C,IAA3CvL,OAAOqB,KAAK+E,CAAkB,EAAEtG,QAElC8D,KAAK4H,aAAa,wBAAwB,EAEzB,MACfC,EAAcC,EAAAA,EAgBlB,GAdA1L,OAAO4G,QAAQR,CAAkB,EAAExE,QAAQ,SAAU+J,GACnD,IAAIC,EAAQzJ,EAAewJ,EAAO,CAAC,EACjC3H,EAAW4H,EAAM,GACjB1F,EAAW0F,EAAM,IACnBL,EAAevH,KACEmH,EAAOnH,WAElB6H,EAAWV,EAAOW,kBAAkBZ,EAAWI,eAAgBpF,EAASV,QAAQ,GACrEiG,IACbA,EAAcI,EACdN,EAAevH,EAGrB,CAAC,EACGuH,EAEF,MAAO,CACL7D,YAAa,SAAqBS,GAChCL,QAAQC,IAAI,0CAA2CwD,EAAcpD,CAAI,EAGzE,IAAI4D,EAAmBZ,EAAOa,uBAAuBZ,EAAWjD,EAAK3C,QAAQ,EAC7E2C,EAAK3C,SAAWuG,EAChBjE,QAAQC,IAAI,mBAAoBI,CAAI,EACpCgD,EAAOjH,QAAQwD,YAAY,CACzBC,OAAQ,cACRH,eAAgB+D,EAChBvD,QAASG,CACX,CAAC,CACH,CACF,EAEAvE,KAAK4H,aAAa,4BAA4B,CAmBlD,CACF,EAAG,CACD3J,IAAK,yBACL3B,MAAO,SAAgCkL,EAAW5F,GAIhD,OAFAA,EAASC,EAAI,CAAC,IACdD,EAASG,EAAI,EACNH,CACT,CACF,EAAG,CACD3D,IAAK,oBACL3B,MAAO,SAA2B+L,EAAQC,GACxC,IAAIC,EAAKF,EAAOxG,EAAIyG,EAAOzG,EACvB2G,EAAKH,EAAOtG,EAAIuG,EAAOvG,EAC3B,OAAOd,KAAKwH,KAAKF,EAAKA,EAAKC,EAAKA,CAAE,CACpC,CACF,EAAG,CACDvK,IAAK,6BACL3B,MAAO,SAAoCoL,GAGzC,IAAIgB,EAAU3N,OAAOoH,WAAa,EAC9BwG,EAAU5N,OAAOsH,YAAc,EACnC,OAAIqF,EAAe7F,EAAI6G,GAAWhB,EAAe3F,EAAI4G,EAAgB,KACjEjB,EAAe7F,GAAK6G,GAAWhB,EAAe3F,EAAI4G,EAAgB,KAClEjB,EAAe7F,GAAK6G,GAAWhB,EAAe3F,GAAK4G,EAAgB,KACnEjB,EAAe7F,EAAI6G,GAAWhB,EAAe3F,GAAK4G,EAAgB,KAAtE,KAAA,CAEF,CACF,EAAG,CACD1K,IAAK,sCACL3B,MAAO,SAA6CkL,IAItD,KAra4EhI,EAAkBW,EAAY5C,UAAWqD,CAAU,EAAOC,GAAarB,EAAkBW,EAAaU,CAAW,EAAGzE,OAAOC,eAAe8D,EAAa,YAAa,CAAE/B,SAAU,CAAA,CAAM,CAAC,EAsa5P2B,CACT,EAAE,CAEF,EAAE,GAAG,EAAE,GAAG,CAAC,EAAE,EAAE,CAAC,CAChB,CAAC"}